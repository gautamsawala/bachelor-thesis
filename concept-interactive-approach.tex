%%%
% Approach for Interactive Diagram-Specific Layout of Graph-based Software Diagrams
%%%

\chapter{Ansatz für das interaktive und diagrammspezifische Layout von graph-basierten Softwarediagrammen}
\label{chapter:interactive-approach}

In diesem Kapitel wird ein Ansatz für das interaktive und diagrammspezifische Layout von Diagrammen präsentiert. Zunächst werden im Abschnitt \ref{sec:requirements-analysis} die Kriterien aufgestellt. Die grundlegende Funktionsweise wird im Abschnitt \ref{sec:interactive-approach-functionality} erklärt. Eine detaillierte Beschreibung der Layout-Patterns und deren Rolle in dem präsentierten Ansatz folgt im Abschnitt \ref{sec:layout-patterns}.
% TODO: Aufbau des Kapitels ergänzen!

\section{Kriterien}
\label{sec:requirements-analysis}

Im Folgenden werden Kriterien für den präsentierten Ansatz aufgestellt. Die Wahl der Kriterien stützt sich in erster Linie auf die Prinzipien für die agile Modellierung aus \cite{Ambler02Agile}. Weiterhin orientieren sich die Kriterien an den im Kapitel \ref{chapter:existing-approaches} vorgestellten Ansätzen, deren positiven Eigenschaften in die Auswahl einfließen.   Schließlich haben auch die ästhetischen Prinzipien (siehe Abschnitt \ref{sec:aesthetics-criteria}) sowie die Rahmenbedingungen dieser Arbeit (siehe Abschnitt \ref{sec:conditions}) einen Einfluss auf die gewählten Kriterien.

\begin{enumerate}[label={K.\arabic*}]
    \item \label{req:gui} \textbf{GUI} Wie bereits im Abschnitt \ref{sec:conditions} erwähnt, beschäftigt sich diese Arbeit ausschließlich mit Mechanismen für das Layout von Diagrammen, die in Tools für klassische grafische Benutzeroberflächen eingesetzt werden. Daher soll der Ansatz für klassische grafische Benutzeroberflächen ausgelegt sein und von üblichen GUI-basierten Bedientechniken wie z.B. \enquote{Drag and Drop} Gebrauch machen.
    \item \label{req:interactivity} \textbf{Interaktivität} Die Manipulation mit dem Diagramm soll interaktiv erfolgen. Der Nutzer soll in der Lage sein, mit dem Diagramm unmittelbar interagieren zu können und die Layout-Anpassungen sollen eine direkte Auswirkung auf das manipulierte Diagramm haben. Demzufolge soll die Eingabe mit der Ausgabe fest gekoppelt sein.
    \item \label{req:editing-support} \textbf{Förderung des Prozesses der Diagramm-Erstellung} Der Nutzer soll den Inhalt des Diagramms bearbeiten und inkrementell modifizieren können \cite{GladischSchumann14Semi-Automatic}. Dabei soll das Layout nach jeder Änderung des Inhalts angepasst werden. Weiterhin soll es möglich sein, das Layout des Diagramms bis zu einem bestimmten Grad nach den Präferenzen des Nutzers beeinflussen zu können.
    \item \textbf{Erhaltung des mentalen Modells} Die Layout-Änderungen im Diagramm sollen möglichst intuitiv erfolgen, insbesondere soll das mentale Modell erhalten werden (siehe Abschnitt \ref{subsec:mental-map}).
    
    \item \label{req:focus-on-the-content} \textbf{Förderung der Konzentration auf den Inhalt} Der Inhalt eines Diagramms soll eine wichtigere Rolle als seine Repräsentation haben \cite[S.38ff]{Ambler02Agile}. Diese Tatsache soll in dem Ansatz berücksichtigt werden, indem der Aufwand für das Erzeugen des Layouts verringert wird. Außerdem sollen die Operationen zur Anpassung der visuellen Eigenschaften möglichst eingeschränkt sein.
    \item \label{req:aesthetics-criteria} \textbf{Berücksichtigung der ästhetischen Prinzipien} Die Layout-Berechnung soll unter Berücksichtigung der im Abschnitt \ref{sec:aesthetics-criteria} beschriebenen ästhetischen Prinzipien für graph-basierte Softwarediagramme erfolgen.
    \item \textbf{Berücksichtigung der Syntax und Semantik} Die Syntax- und Semantikregeln der einzelnen Diagrammtypen sollen berücksichtigt werden und es sollte nicht möglich sein, diese Regeln zu verletzen.    
%    \item \label{req:user-friendly} \textbf{Benutzerfreundlichkeit} Der Ansatz soll möglichst benutzerfreundlich sein. Insbesondere ist wichtig, dass die Einschränkungen bzgl. des Layouts nicht zur Frustration des Nutzers führen.
\end{enumerate}
    
\section{Funktionsweise}
\label{sec:interactive-approach-functionality}

Alle interaktiven Ansätze für das Layout von Diagrammen aus dem Kapitel \ref{chapter:existing-approaches} bis auf das \enquote{Smart Layout} in MindNode (siehe Abschnitt \ref{subsubsec:smart-layout-in-mindnode}) unterstützen eine \textbf{freie Positionierung} der Objekte im Diagramm. Diese Art der Bedienung wird im manuellen Layout zusätzlich um temporäre Hilfefunktionen (siehe Abschnitt \ref{sec:manual-layout}) und in Struktur-basierten benutzergesteuerten Ansätzen um Möglichkeit der Erzeugung von Strukturregeln erweitert*. Durch diese Erweiterungen wird die freie Positionierung eingeschränkt. Dahingegen ist die freie Positionierung in \enquote{Smart Layout} in MindNode und dem in dieser Arbeit präsentierten Ansatz nicht gestattet. Eine Verschiebung eines Objekts im Diagramm bewirkt keine direkte Anpassung seiner Positionen, sondern wird als eine Äußerung der gewünschten Position interpretiert und ausgewertet.









% Aus jeder Operation - Modifizierung des Inhalts (z.B. Hinzufügen eines Knotens) oder des Layouts (z.B. Verschiebung eines Knotens) - wird ein Layout-Ereignis erzeugt
% Auswertung der Layout-Ereignissen durch die Layout-Engine und eventuelle Anpassung des Layouts
% Layout-Übergang

% D&D und Platzhalter-Objekte

% operiert auf dem CSM, verändert die Layout-Eigenschaften




% Einschränkung der Operationen, die der Nutzer ausführen kann

% Abnehmen der Layout-Arbeit durch Einschränkung der Flexibilität

% Herausforderung bei der Kombination von mehreren Kriterien (z.B. interaktive Bedienung aber gleichzeitig eine Einschränkung der Möglichkeiten)
% optimales Verhältnis zwischen flexiblen Modifizierungen der Layout-Eigenschaften und ...

%ausgelegt für Änderungen im Diagramm

%Nutzer hat Einfluss auf das Layout, aber nur zu einem bestimmten Grad

%die Vorteile der freien Positionierung der Elemente im Diagramm und der automatischen Layout-Algorithmen miteinander kombiniert. Unter Berücksichtigung des Diagrammtyps werden durch einen Algorithmus mögliche Layouts berechnet. Der Nutzer wird in der Lage sein, durch Interaktion mit dem Diagramm das passende Layout auszuwählen und neue Elemente zu dem Diagramm hinzuzufügen.

%%%%%%%%%

% Spezialisierung, Einschränkung, Interaktivität

%Durch die Spezialisierung auf konkrete Diagramm-Typen und den Einsatz von verschiedenen Vereinfachungsmaßnahmen wie etwa Einschränkung der unterstützten Notation \cite[S.56ff]{Ambler02Agile} lassen sich Algorithmen für das Layout von Softwarediagrammen entwerfen, die zwar nicht so flexibel wie z.B. \cite{Maier12A-Pattern-based} oder \cite{Eichelberger05Aesthetics} sind, aber dafür...









% Einschränkung der Möglichkeiten, Berücksichtigung der Syntax und Semantik der Diagramme
% Freihand-Bearbeitung --> D&D + Layout-Übergänge
% Interaktivität
% Mauszeiger, GUI
% die Eingabe ist mit der Ausgabe gekoppelt \footnote{Aus der Sicht der HCI ist die Nutzung der Maus als Eingabegerät von der Ausgabe am Monitor entkoppelt.}
% unmittelbares vs. verzögertes Feedback [Wybrow S.69]
% kombiniert Vorteile der freien Positionierung der Elemente im Diagramm und der automatischen Layout-Algorithmen miteinander

% Drag&Drop-Technik (neue Elemente aus einer Palette bzw. Änderung des Layout im Diagramm)
% Platzhalter-Objekte, Animation
% Mentales Modell [Maier, Wybrow?]

%Der Ansatz macht sich sich folgende GUI-Techniken zur Nutze:
%
%\begin{itemize}
%    \item D\&D
%    \item Platzhalter-Objekte im Canvas
%    \item Animation
%\end{itemize}


%\section{Definitionen}

% Layout
% Layout-Übergang
% Layout-Pattern
% Layout-Ereignis

%\section{Funktionsweise}

% Grobe Beschreibung der Funktionalität mit Hinweisen auf kommende Kapitel

% Layout-Engine
% =============
% Eingabe für den Algorithmus: Layout-Ereignis, Inhalt des Diagramms, instanziierte Patterns, der Layout-Zustand (mögliche Layout-Übergänge vom aktuellen Zustand abhängig, nicht alle erreichbar)
% berechnete Layouts = Positionen für Knoten, Routen für Kanten (nicht implementiert), Animationen/Übergangsparameter für die Transitionen (nicht implementiert)
% initialer Zustand

% Erreichbare Layouts werden berechnet und mit Hilfe der Layout-Ereignisse wird geprüft, ob ein Layout-Übergang stattfinden soll (z.B. nur die benachbarten Bereiche im horizontalen Layout-Algorithmus)
% nach einem Layout-Übergang wird die Berechnung wiederholt

% Layout-Engine soll für spezielle Diagrammtypen unterschiedliches Verhalten aufweisen
% Jeder Diagrammtyp (z.B. Klassendiagramm, Zustandsdiagramm, Flowchart usw.) hat aufgrund der Semantik- und Strukturregeln spezielle Anforderungen an das ästhetische Layout
% automatische Instanziierung von Patterns nach Layout-Ereignissen
% Neu-Berechnung nach jedem Layout-Übergang -> Performance?
% Stabilität -> Ausführen eines Layout-Übergangs nach einer deutlichen Aktion des Nutzers
% Erreichbarkeit des Ausgangslayouts

% In Rahmen der Konzeption und Entwicklung wurde zunächst ein Algorithmus entworfen, der für die Manipulation eines Knotens alle möglichen Layouts und die entsprechenden Diagramm-Bereiche für das gesamte Diagramm explizit berechnet hat. Durch eine Bewegung des Mauszeigers in einen anderen Bereich wurde jeweils ein Layout-Übergang ausgelöst. Die Berechnung wurde jedoch nicht nach jedem Layout-Übergang wiederholt und die Abbildung war oft nach dem ersten Layout-Übergang ungültig. Später wurde festgelegt, dass dieser Algorithmus nicht hinreichend ist.

\section{Layout-Patterns}
\label{sec:layout-patterns}

% Abgrenzung des Begriffs zu dem von [Maier]
% implizite vs. explizite Layout-Patterns (siehe Mappe)
% Patterns-Variierung (z.B. Reihenfolge der Knoten kann von Nutzer festgelegt werden, das endgültige Layout wird durch die Geometrie bestimmt)
% instanziiert in der Layout-Engine, referenzieren den Diagramm-Inhalt
% Wiederverwendung möglich (mehrere Instanzen in der Layout-Engine bzw. Komposition von Patterns wie T-Shape-Pattern)
% Nur während Drag&Drop sichtbar -> Möglichkeit der Interaktivität der Patterns
% interne Berechnung des relativen Layouts für enthaltene Diagramm-Objekte (Knoten)

% konkrete Pattens:
% - detaillierte Beschreibung der expliziten Layout-Patterns mit Bezug auf Arbeiten
% - Erläutern der geometrischen Parametern mit Bildern
% - Bild mit Instanzen von Patterns in einem Beispiel-Diagramm (kann ein Screenshot sein)
% - IDLPattern, IDLAlignmentPattern, IDLTShapePattern -> Klassendiagramm

% Instanziierung durch den Nutzer wie in [Maier] ist denkbar

\subsection{Implizite Layout-Patterns}

\subsubsection{Größe der Knoten}
\subsubsection{Zentrierung des Inhalts}
\subsubsection{Gleiche Abstände}
\subsubsection{Verhinderung der Knoten-Überlappung}

\subsection{Explizite Layout-Patterns}

% TODO: Verweis auf die implementierten Patterns im Prototypen (Kapitel 5) hinzufügen
% Variationen der expliziten Layout-Patterns

\subsubsection{Ausrichtung}

% siehe manuelles Layout bzw. Pattern-basierter Ansatz (Kapitel 3)
% gleichmäßige Verteilung (Abstände gleich groß)
% Variationen: Reihenfolge der Knoten

\subsubsection{T-Shape}

% Variationen: Reihenfolge der Knoten im Ausrichtungs-Pattern
% interne Wiederverwendung eines Ausrichtung-Patterns

\section{Layout-Ereignisse}

% Was kann der Nutzer verändern? Was kann er tun?
% Operationen/Aktionen/Arten der Manipulation auflisten

\section{Abgrenzung zu bestehenden Ansätzen}

% Was ist neu an dem Ansatz?
% Vergleich zu bestehenden Ansätzen im Kapitel 3
% Worin unterscheidet sich mein Ansatz zu dem von Sonja Maier?
% - Drag&Drop mit Visualisierung der Aktion
% - Kein Freihand-Editieren, sondern implizite Bereiche und Layout-Übergänge
% - Patterns unterstützen Variierung
% - Starke Vereinfachung der Möglichkeiten (Anpassung der Patterns aus [Maier])
